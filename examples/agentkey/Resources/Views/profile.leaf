#extend("base"):
    #export("content"):
        <section class="profile-header">
            <div class="container">
                <div class="profile-info">
                    #if(agent.avatarUrl):
                        <img src="#(agent.avatarUrl)" alt="#(agent.displayName)" class="profile-avatar">
                    #else:
                        <div class="profile-avatar profile-avatar-placeholder">
                            #(agent.avatarLetter)
                        </div>
                    #endif

                    <div class="profile-details">
                        <h1 class="profile-name">
                            #(agent.displayName)
                            #if(agent.isVerified):
                                <span class="verification-badge verification-badge-large" title="Verified"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg></span>
                            #endif
                            #if(agent.needsSponsor):
                                <span class="unsponsored-badge" title="Unsponsored"><svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4c-1.1 0-2 .9-2 2h4c0-1.1-.9-2-2-2zm0 14c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm0-12c-2.2 0-4 1.8-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.2-1.8-4-4-4z"/></svg></span>
                            #endif
                        </h1>
                        <p class="profile-subject">@#(agent.subject)</p>

                        #if(agent.isSponsored):
                            <p class="sponsor-info">
                                Sponsored by <a href="/#(agent.sponsor.subject)">@#(agent.sponsor.displayName)</a>
                            </p>
                        #endif
                        #if(agent.needsSponsor):
                            <p class="sponsor-info unsponsored">Unsponsored</p>
                        #endif

                        <div class="profile-meta">
                            <span class="badge badge-#(agent.agentType)">#(agent.agentType)</span>

                            #if(agent.homepageUrl):
                                <a href="#(agent.homepageUrl)" class="profile-link" target="_blank" rel="noopener">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: -2px; margin-right: 4px;"><circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>Website
                                </a>
                            #endif

                            <span class="profile-date">Registered #date(agent.createdAt, "MMMM yyyy")</span>
                        </div>
                    </div>

                    <div class="profile-actions">
                        #if(isOwner):
                            <a href="/dashboard/profile" class="btn btn-secondary">Edit Profile</a>
                        #endif
                        #if(canSponsor):
                            <form action="/sponsor/#(agent.id)" method="post" style="display:inline;">
                                <button type="submit" class="btn btn-primary">Sponsor This Agent</button>
                            </form>
                        #endif
                    </div>
                </div>

                #if(agent.description):
                    <p class="profile-description">#(agent.description)</p>
                #endif
            </div>
        </section>

        <section class="section">
            <div class="container">
                <div class="profile-grid">
                    <div class="profile-main">
                        <h2>Signing Keys</h2>

                        #if(hasPublicKeys):
                            <div class="keys-list">
                                #for(key in publicKeys):
                                    #extend("partials/key-card"):
                                        #export("showPublicKey"):true#endexport
                                    #endextend
                                #endfor
                            </div>
                        #else:
                            <div class="empty-state empty-state-small">
                                <p>No public keys registered yet.</p>
                            </div>
                        #endif

                        #if(hasProofs):
                            <h2>Identity Proofs</h2>
                            <div class="proofs-list">
                                #for(proof in proofs):
                                    <div class="proof-card proof-#(proof.status)">
                                        <div class="proof-header">
                                            <span class="proof-type">#(proof.proofType)</span>
                                            <span class="proof-status badge badge-#(proof.status)">#(proof.status)</span>
                                        </div>
                                        <div class="proof-claim">
                                            <strong>#(proof.claim)</strong>
                                        </div>
                                        <div class="proof-data">
                                            <a href="#(proof.proofData)" target="_blank" rel="noopener">View Proof</a>
                                        </div>
                                        #if(proof.verifiedAt):
                                            <div class="proof-verified">
                                                Last verified: #date(proof.verifiedAt, "yyyy-MM-dd HH:mm")
                                            </div>
                                        #endif
                                    </div>
                                #endfor
                            </div>
                        #endif
                    </div>

                    <aside class="profile-sidebar">
                        <div class="sidebar-card">
                            <h3>Verify a Signature</h3>
                            <p>Have a message signed by this identity? Verify it:</p>
                            <a href="/verify?subject=#(agent.subject)" class="btn btn-secondary btn-block">Verify Signature</a>
                        </div>

                        <div class="sidebar-card">
                            <h3>API Access</h3>
                            <p>Get this identity's info via API:</p>
                            <code class="code-block">/api/v1/agents/subject/#(agent.subject)</code>
                        </div>

                        #if(hasRecentActivity):
                            <div class="sidebar-card">
                                <h3>Recent Activity</h3>
                                <ul class="activity-list activity-list-small">
                                    #for(activity in recentActivity):
                                        <li class="activity-item">
                                            <span class="activity-action">#(activity.action)</span>
                                            <span class="activity-time">#date(activity.createdAt, "MMM d")</span>
                                        </li>
                                    #endfor
                                </ul>
                            </div>
                        #endif
                    </aside>
                </div>
            </div>
        </section>
    #endexport
#endextend
